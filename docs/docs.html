
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Convis classes and modules &#8212; convis 0.5.1.0 documentation</title>
    <link rel="stylesheet" href="_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.5.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Filters convis.filters" href="docs_filters.html" />
    <link rel="prev" title="Examples" href="examples.html" /> 
  </head>
  <body>
      <div class="header" role="banner"><h1 class="heading"><a href="index.html">
          <span>convis 0.5.1.0 documentation</span></a></h1>
        <h2 class="heading"><span>Convis classes and modules</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        «&#160;&#160;<a href="examples.html">Examples</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="docs_filters.html">Filters <cite>convis.filters</cite></a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="convis-classes-and-modules">
<h1><a class="toc-backref" href="#id5">Convis classes and modules</a><a class="headerlink" href="#convis-classes-and-modules" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#convis-classes-and-modules" id="id5">Convis classes and modules</a><ul>
<li><a class="reference internal" href="#module-convis.base" id="id6">Base classes <cite>convis.base</cite></a></li>
<li><a class="reference internal" href="#module-convis.utils" id="id7">Utilitary methods <cite>convis.utils</cite></a></li>
<li><a class="reference internal" href="#module-convis.samples" id="id8">Sample Data <cite>convis.samples</cite></a></li>
</ul>
</li>
</ul>
</div>
<p>Further Submodules:</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="docs_filters.html">Filters <cite>convis.filters</cite></a></li>
<li class="toctree-l1"><a class="reference internal" href="docs_models.html">Models <cite>convis.models</cite></a></li>
<li class="toctree-l1"><a class="reference internal" href="docs_streams.html">Streams <cite>convis.streams</cite></a></li>
<li class="toctree-l1"><a class="reference internal" href="docs_retina.html">VirtualRetina-like Simulator</a><ul>
<li class="toctree-l2"><a class="reference internal" href="docs_retina.html#general-overview">General Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="docs_retina.html#references">References</a></li>
<li class="toctree-l2"><a class="reference internal" href="docs_retina.html#module-convis.retina"><cite>convis.retina</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="docs_retina.html#module-convis.filters.retina"><cite>convis.filters.retina</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="docs_retina.html#convis-retina-virtualretina"><cite>convis.retina_virtualretina</cite></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="docs_tests.html">Automatic Tests <cite>convis.tests</cite></a></li>
</ul>
</div>
<span class="target" id="module-convis"></span><div class="section" id="module-convis.base">
<span id="base-classes-convis-base"></span><h2><a class="toc-backref" href="#id6">Base classes <cite>convis.base</cite></a><a class="headerlink" href="#module-convis.base" title="Permalink to this headline">¶</a></h2>
<div class="section" id="convis-base-classes">
<h3>Convis base classes<a class="headerlink" href="#convis-base-classes" title="Permalink to this headline">¶</a></h3>
<p>Convis extends PyTorch by adding some methods to <cite>torch.nn.Module</cite> and calling it a Layer.</p>
<dl class="class">
<dt id="convis.base.Output">
<em class="property">class </em><code class="descclassname">convis.base.</code><code class="descname">Output</code><span class="sig-paren">(</span><em>outs</em>, <em>keys=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/base.html#Output"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.base.Output" title="Permalink to this definition">¶</a></dt>
<dd><p>This object provides a container for output numpy arrays which are labeled with theano variables.</p>
<p>The outputs can be queried either by sorted order (like a simple list),
by the theano variable which represents this output, the name of this variable
or the full path of the variable.
To make this meaningfull, provide a name to your output variables.</p>
<p>In the case of name collisions, the behavior of OrderedDict will use the last variable added.</p>
<p>The full path names of all variables are also added to this objects __dict__,
allowing for tab completion.</p>
</dd></dl>

<dl class="function">
<dt id="convis.base.prepare_input">
<code class="descclassname">convis.base.</code><code class="descname">prepare_input</code><span class="sig-paren">(</span><em>a</em>, <em>dims=5</em>, <em>cuda=False</em>, <em>volatile=False</em>, <em>requires_grad=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/base.html#prepare_input"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.base.prepare_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Utility function to broadcast input to 5 dimensions, make it a Tensor,
wrap it in a Variable and optionally move it to the GPU.</p>
<p>Short hand for:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="n">a_var</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">autograd</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">,:,:,:]),</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">convis.base</span> <span class="k">import</span> <span class="n">prepare_input</span>
<span class="n">a_var</span> <span class="o">=</span> <span class="n">prepare_input</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">cuda</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="convis.base.shape">
<code class="descclassname">convis.base.</code><code class="descname">shape</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/base.html#shape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.base.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the shape of a Tensor or Variable containing a Tensor.</p>
</dd></dl>

<dl class="class">
<dt id="convis.base.Layer">
<em class="property">class </em><code class="descclassname">convis.base.</code><code class="descname">Layer</code><a class="reference internal" href="_modules/convis/base.html#Layer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.base.Layer" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for modules, layers and models.</p>
<p><cite>convis.Layer</cite> is a <cite>torch.nn.Module</cite> with some added functionality:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">convis</span>
<span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>

<span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="n">convis</span><span class="o">.</span><span class="n">Layer</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Model</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conv1</span> <span class="o">=</span> <span class="n">convis</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">Conv3d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conv2</span> <span class="o">=</span> <span class="n">convis</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">Conv3d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
       <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conv1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
       <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conv2</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
<p>Just as <cite>Module`s, `Layer`s can include other `Layer`s or `Module`s (ie. its `sublayers</cite>).
<cite>Variable`s, `Parameter`s and `State`s that are attributes of a Layer or
its `sublayers</cite> will be registered and can be collected according to their
class.</p>
<p>All registered Variables (including Parameters and States), will be moved to the
corresponding device when calling <cite>.cuda()</cite> or <cite>.cpu()</cite>.</p>
<p>In contrast to many methods of torch.Tensors, Layer methods are always
in-place! Using <cite>.cuda()</cite> or <cite>.float()</cite> will return a reference to the 
original model and not a copy.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference external" href="http://pytorch.org/docs/0.3.0/nn.html#torch.nn.Module" title="(in PyTorch vmaster (0.3.0.post4 ))"><code class="xref py py-obj docutils literal"><span class="pre">torch.nn.Module</span></code></a></dt>
<dd>torchs layer class</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">convis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>
<span class="gp">&gt;&gt;&gt; </span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="n">convis</span><span class="o">.</span><span class="n">Layer</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="nb">super</span><span class="p">(</span><span class="n">Model</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="bp">self</span><span class="o">.</span><span class="n">conv1</span> <span class="o">=</span> <span class="n">convis</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">Conv3d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="bp">self</span><span class="o">.</span><span class="n">conv2</span> <span class="o">=</span> <span class="n">convis</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">Conv3d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conv1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conv2</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
<p id="tab-completion-example">Selecting an <a class="reference external" href="http://pytorch.org/docs/0.3.0/optim.html#torch.optim.Optimizer" title="(in PyTorch vmaster (0.3.0.post4 ))"><code class="xref py py-class docutils literal"><span class="pre">Optimizer</span></code></a> and using it with <a class="reference internal" href="#convis.base.Layer.optimize" title="convis.base.Layer.optimize"><code class="xref py py-meth docutils literal"><span class="pre">optimize()</span></code></a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">convis</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">LN</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">set_optimizer</span><span class="o">.&lt;</span><span class="n">then</span> <span class="n">press</span> <span class="n">tab</span><span class="o">&gt;</span>
<span class="go">                    ASGD</span>
<span class="go">                    Adadelta</span>
<span class="go">                    Adagrad</span>
<span class="go">                    Adam</span>
<span class="go">                    ...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">set_optimizer</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">lr</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">output</span><span class="p">)</span>
</pre></div>
</div>
<p>The list of parameters as first argument can be omitted
and will be filled with all parameters of the model by
default. Other parameters are passed through to the optimizer
eg. the learning rate <code class="xref py py-attr docutils literal"><span class="pre">lr</span></code> in this example.</p>
<p id="tab-completion-special-attributes-example">The special attributes <cite>p</cite>,`m`,`s` and <cite>user_parameters</cite>
provide tab-completion for parameters, submodules and states:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">retina</span> <span class="o">=</span> <span class="n">convis</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">retina</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">retina</span><span class="o">.</span><span class="n">p</span>
<span class="go">Parameters of the model (see also .user_parameters)</span>
<span class="go">Choices: gang_0_spikes, gang_1_spikes, gang_0_input, gang_1_input, bipolar, opl</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">retina</span><span class="o">.</span><span class="n">user_parameters</span>
<span class="go">Parameters of the model that can be set by the user.</span>
<span class="go">Choices: gang_0_spikes, gang_1_spikes, gang_0_input, gang_1_input, bipolar, opl</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">retina</span><span class="o">.</span><span class="n">p</span>
<span class="go">Modules of the model</span>
<span class="go">Choices: _self, gang_0_spikes, gang_1_spikes, gang_0_input, gang_1_input, bipolar, opl</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">retina</span><span class="o">.</span><span class="n">s</span>
<span class="go">Current state of the model</span>
<span class="go">Choices: gang_0_spikes, gang_1_spikes, gang_0_input, gang_1_input, bipolar, opl</span>
</pre></div>
</div>
<p>To find explore the parameters / modules / states,
print the object to see the available choices or
press tab:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">retina</span><span class="o">.</span><span class="n">p</span><span class="o">.&lt;</span><span class="n">tab</span> <span class="n">complete</span><span class="o">&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">retina</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">bi</span><span class="o">&lt;</span><span class="n">tab</span> <span class="n">complete</span><span class="o">&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">retina</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">bipolar</span><span class="o">.&lt;</span><span class="n">tab</span> <span class="n">complete</span><span class="o">&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">retina</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">bipolar</span><span class="o">.</span><span class="n">g_leak</span> <span class="c1"># the g_leak Parameter</span>
</pre></div>
</div>
<p>The hierarchical <code class="xref py py-class docutils literal"><span class="pre">Ox</span></code> object provides 
a few special functions</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">retina</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">_all</span><span class="o">.</span><span class="n">bipolar_g_leak</span> <span class="c1"># lists everything in a flat list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">retina</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">_search</span><span class="o">.</span><span class="n">leak</span><span class="o">.&lt;</span><span class="n">tab</span> <span class="n">complete</span> <span class="n">to</span> <span class="n">search</span><span class="o">&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">retina</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">_search</span><span class="o">.</span><span class="n">leak</span><span class="o">.</span><span class="n">bipolar_g_leak</span> <span class="c1"># found one result</span>
</pre></div>
</div>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>_use_cuda</strong></td>
<td>(bool)</td>
</tr>
<tr class="row-even"><td><strong>.. py:attribute:: set_optimizer</strong></td>
<td><code class="xref py py-class docutils literal"><span class="pre">magic</span> <span class="pre">object</span></code> that allows tab completion to select an optimizer. (see <a class="reference internal" href="#tab-completion-example"><span class="std std-ref">example</span></a>)  The list of parameters as first argument can be omitted and will be filled with all parameters of the model by default. Other parameters are passed through to the optimizer.</td>
</tr>
<tr class="row-odd"><td><strong>.. py:attribute:: user_parameteres</strong></td>
<td>A hierarchical, tab-completable list of all <code class="xref py py-class docutils literal"><span class="pre">set()</span></code> function for the user.</td>
</tr>
<tr class="row-even"><td><strong>.. py:attribute:: m</strong></td>
<td>A hierarchical, tab-completable list of all :class:<a href="#id1"><span class="problematic" id="id2">`</span></a>~torch.nn.Module`s/:class:<a href="#id3"><span class="problematic" id="id4">`</span></a>~convis.base.Layer`s of the model.</td>
</tr>
<tr class="row-odd"><td><strong>.. py:attribute:: s</strong></td>
<td>A hierarchical, tab-completable list of all state variables of the model.</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>cuda(device=None)</strong></td>
<td>move the model to the gpu</td>
</tr>
<tr class="row-even"><td><strong>cpu()</strong></td>
<td>move the model to the cpu</td>
</tr>
<tr class="row-odd"><td><strong>run(the_input, dt=None)</strong></td>
<td>execute the model, using chunk sizes of <cite>dt</cite></td>
</tr>
<tr class="row-even"><td><strong>parse_config(conf)</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><strong>optimize(inp,outp,dt=None)</strong></td>
<td>use the selected optimizer to fit the model to return outp to the input inp. Accepts a chunk length <cite>dt</cite></td>
</tr>
<tr class="row-even"><td><strong>register_state(name, value)</strong></td>
<td>registers an attribute name to be a state variable</td>
</tr>
<tr class="row-odd"><td><strong>state()</strong></td>
<td>returns the current state of the model (recursively for all submodules)</td>
</tr>
<tr class="row-even"><td><strong>set_state(d)</strong></td>
<td>set all state parameters defined in dictionary <cite>d</cite> to the corresponding values.</td>
</tr>
<tr class="row-odd"><td><strong>push_state()</strong></td>
<td>pushes the current state on a stack</td>
</tr>
<tr class="row-even"><td><strong>pop_state()</strong></td>
<td>pops the last state from the stack and sets all state variables to the corresponding values.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="convis.base.Layer.cuda">
<code class="descname">cuda</code><span class="sig-paren">(</span><em>device=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/base.html#Layer.cuda"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.base.Layer.cuda" title="Permalink to this definition">¶</a></dt>
<dd><p>Moves the model to the GPU (optionally with number <cite>device</cite>).
returns the model itself.</p>
</dd></dl>

<dl class="method">
<dt id="convis.base.Layer.cpu">
<code class="descname">cpu</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/base.html#Layer.cpu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.base.Layer.cpu" title="Permalink to this definition">¶</a></dt>
<dd><p>Moves the model to the CPU and returns the model itself.</p>
</dd></dl>

<dl class="method">
<dt id="convis.base.Layer.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>the_input</em>, <em>dt=None</em>, <em>t=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/base.html#Layer.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.base.Layer.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs the model either once, or multiple times to process chunks of size <cite>dt</cite>.</p>
<p>Returns an <cite>Output</cite> object.</p>
</dd></dl>

<dl class="attribute">
<dt id="convis.base.Layer.p">
<code class="descname">p</code><a class="headerlink" href="#convis.base.Layer.p" title="Permalink to this definition">¶</a></dt>
<dd><p>A hierarchical, tab-completable list of all <code class="xref py py-class docutils literal"><span class="pre">torch.nn.parameter.Parameter</span></code> of the model.
If a parameters is reachable via <cite>some_model.p.layer1.module1.parameter1</cite>
it will also be available directly as <cite>some_model.layer1.module1.parameter1</cite>.
However for tab-completion, the later method provides <em>all</em> attributes
of the model, not only parameters.</p>
</dd></dl>

<dl class="method">
<dt id="convis.base.Layer.parse_config">
<code class="descname">parse_config</code><span class="sig-paren">(</span><em>config</em>, <em>prefix=''</em>, <em>key='retina_config_key'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/base.html#Layer.parse_config"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.base.Layer.parse_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads parameter values from a configuration (RetinaConfiguration or dict).</p>
</dd></dl>

<dl class="method">
<dt id="convis.base.Layer.optimize">
<code class="descname">optimize</code><span class="sig-paren">(</span><em>inp</em>, <em>outp</em>, <em>optimizer=None</em>, <em>loss_fn=&lt;function &lt;lambda&gt;&gt;</em>, <em>dt=None</em>, <em>t=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/base.html#Layer.optimize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.base.Layer.optimize" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs an Optimizer to fit the models parameters such that the output
of the model when presented <code class="xref py py-attr docutils literal"><span class="pre">inp</span></code> approximates <code class="xref py py-attr docutils literal"><span class="pre">outp</span></code>.</p>
<p>To use this function, an <a class="reference external" href="http://pytorch.org/docs/0.3.0/optim.html#torch.optim.Optimizer" title="(in PyTorch vmaster (0.3.0.post4 ))"><code class="xref py py-class docutils literal"><span class="pre">torch.optim.Optimizer</span></code></a> has to be selected:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">set_optimizer</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span><span class="n">lr</span><span class="o">=</span><span class="mf">0.01</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">set_optimizer</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">lr</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span> <span class="c1"># uses optimizers from torch.optim</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<p>It is important to specify a chunk length <code class="xref py py-attr docutils literal"><span class="pre">dt</span></code>, if the complete input does not fit into memory.</p>
</dd></dl>

<dl class="method">
<dt id="convis.base.Layer.state">
<code class="descname">state</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/base.html#Layer.state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.base.Layer.state" title="Permalink to this definition">¶</a></dt>
<dd><p>collects the state and returns an
OrderedDict</p>
</dd></dl>

<dl class="method">
<dt id="convis.base.Layer.set_state">
<code class="descname">set_state</code><span class="sig-paren">(</span><em>state_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/base.html#Layer.set_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.base.Layer.set_state" title="Permalink to this definition">¶</a></dt>
<dd><p>collects the state and returns an
OrderedDict</p>
</dd></dl>

<dl class="method">
<dt id="convis.base.Layer.clear_state">
<code class="descname">clear_state</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/base.html#Layer.clear_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.base.Layer.clear_state" title="Permalink to this definition">¶</a></dt>
<dd><p>resets the state to default values</p>
</dd></dl>

<dl class="method">
<dt id="convis.base.Layer.push_state">
<code class="descname">push_state</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/base.html#Layer.push_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.base.Layer.push_state" title="Permalink to this definition">¶</a></dt>
<dd><p>collects all State variables and pushes they values onto a stack</p>
</dd></dl>

<dl class="method">
<dt id="convis.base.Layer.pop_state">
<code class="descname">pop_state</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/base.html#Layer.pop_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.base.Layer.pop_state" title="Permalink to this definition">¶</a></dt>
<dd><p>retrieves the values of all State variables and from a stack</p>
</dd></dl>

<dl class="method">
<dt id="convis.base.Layer.plot_impulse">
<code class="descname">plot_impulse</code><span class="sig-paren">(</span><em>shp=(500</em>, <em>10</em>, <em>10)</em>, <em>dt=500</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/base.html#Layer.plot_impulse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.base.Layer.plot_impulse" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the response to a 1 bin impulse.</p>
<p>The state of the model is preserved (pushed 
to the stack and poped later).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The output of the model</td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="6%" />
<col width="94%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>shp</strong></td>
<td>(tuple(t, x, y)) the size of the stimulus. A larger stimulus will show a larger area of the impulse response</td>
</tr>
<tr class="row-even"><td><strong>dt</strong></td>
<td>(int) length of chunks when computing the response</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="attribute">
<dt id="convis.base.Model">
<code class="descclassname">convis.base.</code><code class="descname">Model</code><a class="headerlink" href="#convis.base.Model" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#convis.base.Layer" title="convis.base.Layer"><code class="xref py py-class docutils literal"><span class="pre">Layer</span></code></a></p>
</dd></dl>

<dl class="class">
<dt id="convis.base.Runner">
<em class="property">class </em><code class="descclassname">convis.base.</code><code class="descname">Runner</code><span class="sig-paren">(</span><em>model=None</em>, <em>input=None</em>, <em>output=None</em>, <em>goal=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/base.html#Runner"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.base.Runner" title="Permalink to this definition">¶</a></dt>
<dd><p>Keeps track of the input and output of a model
and can run or optimize it in a separate thread.</p>
<p><code class="xref py py-attr docutils literal"><span class="pre">model</span></code> has to be a <a class="reference internal" href="#convis.base.Layer" title="convis.base.Layer"><code class="xref py py-class docutils literal"><span class="pre">convis.base.Layer</span></code></a></p>
<p><code class="xref py py-attr docutils literal"><span class="pre">input</span></code> should be a <a class="reference internal" href="docs_streams.html#convis.streams.Stream" title="convis.streams.Stream"><code class="xref py py-class docutils literal"><span class="pre">convis.streams.Stream</span></code></a> that contains input data
<code class="xref py py-attr docutils literal"><span class="pre">output</span></code> should be a <a class="reference internal" href="docs_streams.html#convis.streams.Stream" title="convis.streams.Stream"><code class="xref py py-class docutils literal"><span class="pre">convis.streams.Stream</span></code></a> that accepts new data
when using optimize, <code class="xref py py-attr docutils literal"><span class="pre">goal</span></code> has to have the same length as input and the same behaviour at the end of the stream (repeating or stop)</p>
<dl class="method">
<dt id="convis.base.Runner.stop">
<code class="descname">stop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/base.html#Runner.stop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.base.Runner.stop" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="convis.base.Runner.start">
<code class="descname">start</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/base.html#Runner.start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.base.Runner.start" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="convis.base.Runner.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>length=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/base.html#Runner.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.base.Runner.run" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="convis.base.Runner.optimize">
<code class="descname">optimize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/base.html#Runner.optimize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.base.Runner.optimize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-convis.utils">
<span id="utilitary-methods-convis-utils"></span><h2><a class="toc-backref" href="#id7">Utilitary methods <cite>convis.utils</cite></a><a class="headerlink" href="#module-convis.utils" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="convis.utils.plot_5d_matshow">
<code class="descclassname">convis.utils.</code><code class="descname">plot_5d_matshow</code><span class="sig-paren">(</span><em>w, border=True, dims=[(0, 1, 3), (2, 4)], border_val=0.0, **kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/utils.html#plot_5d_matshow"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.utils.plot_5d_matshow" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots a 5d Tensor as a concatenation of spatial maps.</p>
<p>The 5 dimensions have to be separated into two sets which
will correspond to the two dimensions of the image.</p>
<blockquote>
<div>plot_5d_matshow(w, dims=[(0,3),(2,1,4)])</div></blockquote>
<p>Other arguments and keyword arguments are passed
to <cite>matplotlib.pylab.plot()</cite></p>
<p><cite>border_val</cite> can be a float value or ‘max’, ‘min’ or ‘mean’,
in which case the corresponding value will be taken from w.</p>
</dd></dl>

<dl class="function">
<dt id="convis.utils.plot_5d_time">
<code class="descclassname">convis.utils.</code><code class="descname">plot_5d_time</code><span class="sig-paren">(</span><em>w</em>, <em>lsty='-'</em>, <em>mean=()</em>, <em>time=(2</em>, <em>)</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/utils.html#plot_5d_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.utils.plot_5d_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots a line plot from a 5d tensor.</p>
<p>Dimensions in argument <cite>mean</cite> will be combined.
If <cite>mean</cite> is <cite>True</cite>, all 4 non-time dimensions will be 
averaged.</p>
<p>Other arguments and keyword arguments are passed
to <cite>matplotlib.pylab.plot()</cite></p>
</dd></dl>

</div>
<div class="section" id="module-convis.samples">
<span id="sample-data-convis-samples"></span><h2><a class="toc-backref" href="#id8">Sample Data <cite>convis.samples</cite></a><a class="headerlink" href="#module-convis.samples" title="Permalink to this headline">¶</a></h2>
<p>This module provides sample kernels and inputs.</p>
<dl class="function">
<dt id="convis.samples.random_checker_stimulus">
<code class="descclassname">convis.samples.</code><code class="descname">random_checker_stimulus</code><span class="sig-paren">(</span><em>t=2000</em>, <em>x=20</em>, <em>y=20</em>, <em>checker_size=5</em>, <em>seed=123</em>, <em>frames_per_second=None</em>, <em>pixel_per_degree=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/samples.html#random_checker_stimulus"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.samples.random_checker_stimulus" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a random checker flicker of uniformly distributed values
in a grid of <cite>checker_size`x`checker_size</cite> pixels.</p>
</dd></dl>

<dl class="class">
<dt id="convis.samples.StimulusSize">
<em class="property">class </em><code class="descclassname">convis.samples.</code><code class="descname">StimulusSize</code><span class="sig-paren">(</span><em>t=2000</em>, <em>x=20</em>, <em>y=20</em>, <em>pixel_per_degree=10</em>, <em>frames_per_second=1000.0</em>, <em>cuda=False</em>, <em>prepare=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/samples.html#StimulusSize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.samples.StimulusSize" title="Permalink to this definition">¶</a></dt>
<dd><p>This class holds information about sample stimulus size.</p>
</dd></dl>

<dl class="class">
<dt id="convis.samples.SampleGenerator">
<em class="property">class </em><code class="descclassname">convis.samples.</code><code class="descname">SampleGenerator</code><span class="sig-paren">(</span><em>kernel='random'</em>, <em>kernel_size=(10</em>, <em>5</em>, <em>5)</em>, <em>dt=100</em>, <em>p=0.1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/samples.html#SampleGenerator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.samples.SampleGenerator" title="Permalink to this definition">¶</a></dt>
<dd><p>A Linear-Nonlinear model with a random kernel/weight
that generates random input/output combinations for
testing purposes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>kernel</strong> : str or numpy array</p>
<blockquote>
<div><p>Possible values for <cite>kernel</cite>:</p>
<blockquote>
<div><p>‘random’ or ‘randn’: normal distributed kernel values</p>
<p>‘rand’: random kernel values bounded between 0 and 1</p>
<dl class="docutils">
<dt>‘sparse’: a kernel with a ratio of (approx).</dt>
<dd><p class="first last"><cite>p</cite> 1s and 1-<cite>p</cite> 0s, randomly assigned.</p>
</dd>
</dl>
<p>or a 5d or 3d numpy array</p>
</div></blockquote>
</div></blockquote>
<p><strong>kernel_size</strong> : tuple(int,int,int)</p>
<blockquote>
<div><p>specifies the dimensions of the generated input</p>
</div></blockquote>
<p><strong>dt</strong> : int</p>
<blockquote>
<div><p>length of chunks when evaluating the model</p>
</div></blockquote>
<p><strong>p</strong> : float</p>
<blockquote class="last">
<div><p>the ratio of 1s for sparse input</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#convis.samples.generate_sample_data" title="convis.samples.generate_sample_data"><code class="xref py py-obj docutils literal"><span class="pre">convis.samples.generate_sample_data</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">convis</span><span class="o">.</span><span class="n">samples</span><span class="o">.</span><span class="n">SampleGenerator</span><span class="p">(</span><span class="s1">&#39;sparse&#39;</span><span class="p">,</span><span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">p</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">convis</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">LN</span><span class="p">((</span><span class="mi">50</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">set_optimizer</span><span class="o">.</span><span class="n">Adam</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>conv</strong></td>
<td>(convis.filters.Conv3d) the convolution operation (including the weight)</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="docutils">
<colgroup>
<col width="36%" />
<col width="64%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>generate(input,size,p)</strong></td>
<td>generates random input and corresponding output</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="convis.samples.SampleGenerator.generate">
<code class="descname">generate</code><span class="sig-paren">(</span><em>input='random'</em>, <em>size=(2000</em>, <em>20</em>, <em>20)</em>, <em>p=0.1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/samples.html#SampleGenerator.generate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.samples.SampleGenerator.generate" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>input</strong> : str or numpy array</p>
<blockquote>
<div><p>Possible values for <cite>input</cite>:</p>
<blockquote>
<div><ul class="simple">
<li>‘random’ or ‘randn’: normal distributed input</li>
<li>‘rand’: random input values bounded between 0 and 1</li>
<li><dl class="first docutils">
<dt>‘sparse’: input with a ratio of (approx).</dt>
<dd><cite>p</cite> 1s and 1-<cite>p</cite> 0s, randomly assigned.</dd>
</dl>
</li>
<li>or a 3d or 5d numpy array.</li>
</ul>
</div></blockquote>
<p>If input is anything else, <cite>generate</cite> tries to use it
as input to the model.</p>
</div></blockquote>
<p><strong>size</strong> : tuple(int,int,int)</p>
<blockquote>
<div><p>specifies the dimensions of the generated input</p>
</div></blockquote>
<p><strong>p</strong> : float</p>
<blockquote>
<div><p>the ratio of 1s for sparse input</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>x</strong> :  PyTorch Tensor</p>
<blockquote>
<div><p>the randomly created input input</p>
</div></blockquote>
<p><strong>y</strong> :  PyTorch Variable</p>
<blockquote class="last">
<div><p>the corresponding output</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="convis.samples.generate_sample_data">
<code class="descclassname">convis.samples.</code><code class="descname">generate_sample_data</code><span class="sig-paren">(</span><em>input='random'</em>, <em>size=(2000</em>, <em>20</em>, <em>20)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/samples.html#generate_sample_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.samples.generate_sample_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates random input and sample output using 
a <cite>SampleGenerator</cite> with a random kernel.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>input</strong> : str or numpy array</p>
<blockquote>
<div><p>Possible values for <cite>input</cite>:</p>
<blockquote>
<div><ul class="simple">
<li>‘random’ or ‘randn’: normal distributed input</li>
<li>‘rand’: random input values bounded between 0 and 1</li>
<li><dl class="first docutils">
<dt>‘sparse’: input with a ratio of (approx).</dt>
<dd><cite>p</cite> 1s and 1-<cite>p</cite> 0s, randomly assigned.</dd>
</dl>
</li>
<li>or a 3d or 5d numpy array.</li>
</ul>
</div></blockquote>
</div></blockquote>
<p><strong>size</strong> : tuple(int,int,int)</p>
<blockquote>
<div><p>specifies the dimensions of the generated input</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>x</strong> :  PyTorch Tensor</p>
<blockquote>
<div><p>the randomly created input input</p>
</div></blockquote>
<p><strong>y</strong> :  PyTorch Variable</p>
<blockquote>
<div><p>the corresponding output</p>
</div></blockquote>
<p>The kernel will be different each time</p>
<p><cite>convis</cite> is (re)loaded, but constant in one</p>
<p>session. The “secret” <cite>SampleGenerator</cite> is</p>
<p class="last">available as <cite>convis.samples._g</cite>.</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#convis.samples.SampleGenerator" title="convis.samples.SampleGenerator"><code class="xref py py-obj docutils literal"><span class="pre">SampleGenerator</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">convis</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">LN</span><span class="p">((</span><span class="mi">50</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">set_optimizer</span><span class="o">.</span><span class="n">Adam</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">convis</span><span class="o">.</span><span class="n">samples</span><span class="o">.</span><span class="n">generate_sample_data</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>


      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        «&#160;&#160;<a href="examples.html">Examples</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="docs_filters.html">Filters <cite>convis.filters</cite></a>&#160;&#160;»
        </p>

      </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, Jacob Huth.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.6.
    </div>
  </body>
</html>