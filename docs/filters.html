
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Filters and Layers &#8212; convis 0.5.1.1 documentation</title>
    <link rel="stylesheet" href="_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.5.1.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Extending Conv3d" href="filters_Conv3d.html" />
    <link rel="prev" title="Examples" href="examples.html" /> 
  </head>
  <body>
      <div class="header" role="banner"><h1 class="heading"><a href="index.html">
          <span>convis 0.5.1.1 documentation</span></a></h1>
        <h2 class="heading"><span>Filters and Layers</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        «&#160;&#160;<a href="examples.html">Examples</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="filters_Conv3d.html">Extending Conv3d</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="filters-and-layers">
<h1>Filters and Layers<a class="headerlink" href="#filters-and-layers" title="Permalink to this headline">¶</a></h1>
<div class="section" id="convolution-filters">
<h2>Convolution Filters<a class="headerlink" href="#convolution-filters" title="Permalink to this headline">¶</a></h2>
<p><cite>covnis.filters.Conv3d</cite> is the basic 3d convolution filter and based on <cite>torch.nn.Conv3d</cite>.
It can dynamically pad the input in <cite>x</cite> and <cite>y</cite> dimensions to keep the output the same size as the input.
The time dimension has to be padded by another operation.</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">conv</span> <span class="o">=</span> <span class="n">covnis</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">Conv3d</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">out_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span><span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">conv</span><span class="o">.</span><span class="n">weight</span><span class="p">)</span> <span class="c1"># the weight parameter</span>
<span class="nb">print</span><span class="p">(</span><span class="n">conv</span><span class="o">.</span><span class="n">bias</span><span class="p">)</span>   <span class="c1"># the bias parameter</span>
<span class="n">conv</span><span class="o">.</span><span class="n">set_weight</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">some_output</span> <span class="o">=</span> <span class="n">conv</span><span class="p">(</span><span class="n">some_input</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Currently, the nd convolution operation can leak memory when fitting a model!</p>
</div>
<dl class="class">
<dt id="convis.filters.Conv3d">
<em class="property">class </em><code class="descclassname">convis.filters.</code><code class="descname">Conv3d</code><span class="sig-paren">(</span><em>in_channels=1</em>, <em>out_channels=1</em>, <em>kernel_size=(1</em>, <em>1</em>, <em>1)</em>, <em>bias=True</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/filters.html#Conv3d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.filters.Conv3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Does a convolution, but pads the input in time
with previous input and in space by replicating
the edge.</p>
<p>Arguments:</p>
<blockquote>
<div><ul class="simple">
<li>in_channels</li>
<li>out_channels</li>
<li>kernel_size</li>
<li>bias (bool)</li>
</ul>
</div></blockquote>
<p>Additional PyTorch Conv3d keyword arguments:</p>
<blockquote>
<div><ul class="simple">
<li>padding (should not be used)</li>
<li>stride</li>
<li>dilation</li>
<li>groups</li>
</ul>
</div></blockquote>
<p>Additional convis Conv3d keyword arguments:</p>
<blockquote>
<div><ul class="simple">
<li>time_pad: False (enables padding in time)</li>
<li>autopad: False (enables padding in space)</li>
</ul>
</div></blockquote>
<p>To change the weight, use the method <cite>set_weight()</cite>
which also accepts numpy arguments.</p>
<dl class="method">
<dt id="convis.filters.Conv3d.set_weight">
<code class="descname">set_weight</code><span class="sig-paren">(</span><em>w</em>, <em>normalize=False</em>, <em>preserve_channels=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/filters.html#Conv3d.set_weight"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.filters.Conv3d.set_weight" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets a new weight for the convolution.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>w: numpy array or PyTorch Tensor</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>The new kernel <cite>w</cite> should have 1,2,3 or 5 dimensions.</dt>
<dd><p class="first">1 dimensions: temporal kernel
2 dimensions: spatial kernel
3 dimensions: spatio-temporal kernel (time,x,y)
5 dimensions: spatio-temporal kernels for multiple channels</p>
<blockquote class="last">
<div><p>(out_channels, in_channels, time, x, y)</p>
</div></blockquote>
</dd>
</dl>
<p>If the new kernel has 1, 2 or 3 dimensions and 
<cite>preserve_channels</cite> is <cite>True</cite>, the input and output 
channels will be preserved and the same kernel
will be applied to all channel combinations.
(ie. each output channel recieves the sum of all
input channels).
This makes sense if the kernel is further optimized,
otherwise, the same effect can be achieved with a 
single input and output channel more effectively.</p>
</div></blockquote>
<p><strong>normalize: bool (default: False)</strong></p>
<blockquote>
<div><p>Whether or not the sum of the kernel values
should be normalized to 1, such that the
sum over all input values and all output 
values is the approximately same.</p>
</div></blockquote>
<p><strong>preserve_channels: bool (default: False)</strong></p>
<blockquote class="last">
<div><p>Whether or not to copy smaller kernels
to all input-output channel combinations.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<p>Spatial gaussian filters and temporal exponential filters can be generated with functions from the <cite>convis.numerical_filters</cite> submodule.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">convis</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">convis</span><span class="o">.</span><span class="n">numerical_filters</span><span class="o">.</span><span class="n">gauss_filter_2d</span><span class="p">(</span><span class="mf">4.0</span><span class="p">,</span><span class="mf">4.0</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">convis</span><span class="o">.</span><span class="n">numerical_filters</span><span class="o">.</span><span class="n">exponential_filter_1d</span><span class="p">(</span><span class="n">tau</span><span class="o">=</span><span class="mf">0.01</span><span class="p">))</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//filters-1.py">Source code</a>)</p>
<div class="figure" id="id1">
<img alt="_images/filters-1_00.png" src="_images/filters-1_00.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href=".//filters-1_00.png">png</a>, <a class="reference external" href=".//filters-1_00.hires.png">hires.png</a>, <a class="reference external" href=".//filters-1_00.pdf">pdf</a>)</span></p>
</div>
<div class="figure" id="id2">
<img alt="_images/filters-1_01.png" src="_images/filters-1_01.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href=".//filters-1_01.png">png</a>, <a class="reference external" href=".//filters-1_01.hires.png">hires.png</a>, <a class="reference external" href=".//filters-1_01.pdf">pdf</a>)</span></p>
</div>
</div>
<div class="section" id="receptive-fields">
<h2>Receptive Fields<a class="headerlink" href="#receptive-fields" title="Permalink to this headline">¶</a></h2>
<p>While a convolution will pad the input to keep the size of the output equal to the input,
a receptive field filter will produce a single time series.</p>
<dl class="class">
<dt id="convis.filters.RF">
<em class="property">class </em><code class="descclassname">convis.filters.</code><code class="descname">RF</code><span class="sig-paren">(</span><em>in_channels=1</em>, <em>out_channels=1</em>, <em>kernel_size=(1</em>, <em>1</em>, <em>1)</em>, <em>bias=True</em>, <em>rf_mode='corner'</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/filters.html#RF"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.filters.RF" title="Permalink to this definition">¶</a></dt>
<dd><p>A Receptive Field Layer</p>
<p>Does a convolution and pads the input in time
with previous input, just like Conv3d, but with
no spatial padding, resulting in a single output
pixel.</p>
<p>To use it correctly, the weight should be set to 
the same spatial dimensions as the input.
However, if the weight is larger than the input
or the input is larger than the weight,
the input is padded or cut. The parameter <cite>rf_mode</cite>
controls the placement of the receptive field
on the image.</p>
<p>Currently, only rf_mode=’corner’ is implemented,
which keeps the top left pixel identical and only
extends or cuts the right and bottom portions
of the input.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>The spatial extent of your weight should match your input images to 
get meaningful receptive fields. Otherwise the receptive field is placed
at the top left corner of the input.</p>
<p>If the weight was not set manually, the first time the filter sees input
it creates an empty weight of the matching size. However when
the input size is changed, the weight does not change automatically
to match new input. Use <code class="xref py py-meth docutils literal"><span class="pre">reset_weight()</span></code> to reset the weight
or change the size manually.</p>
<p class="last">Any receptive field of size 1 by 1 pixel is considered
empty and will be replaced with a uniform
weight of the size of the input the next time
the filter is used.</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#convis.filters.Conv3d" title="convis.filters.Conv3d"><code class="xref py py-obj docutils literal"><span class="pre">Conv3d</span></code></a></p>
</div>
<p>Or as a part of a cascade model:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">convis</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">LNCascade</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">convis</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">Conv3d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">convis</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">RF</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,(</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>
<span class="go">    # this RF will take into account 10 timesteps, it&#39;s width and height will be set by the input</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inp</span> <span class="o">=</span> <span class="n">convis</span><span class="o">.</span><span class="n">samples</span><span class="o">.</span><span class="n">moving_grating</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">convis</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">convis</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">RF</span><span class="p">()</span>
<span class="n">inp</span> <span class="o">=</span> <span class="n">convis</span><span class="o">.</span><span class="n">samples</span><span class="o">.</span><span class="n">moving_grating</span><span class="p">()</span>
<span class="n">o</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">o</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;uniform rf&#39;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">set_weight</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="o">*</span><span class="n">m</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">size</span><span class="p">()))</span>
<span class="n">o</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">o</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;random rf&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//filters-2.py">Source code</a>, <a class="reference external" href=".//filters-2.png">png</a>, <a class="reference external" href=".//filters-2.hires.png">hires.png</a>, <a class="reference external" href=".//filters-2.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/filters-2.png" src="_images/filters-2.png" />
</div>
</div>
<div class="section" id="recursive-temporal-filters">
<h2>Recursive Temporal Filters<a class="headerlink" href="#recursive-temporal-filters" title="Permalink to this headline">¶</a></h2>
<p>There are two filters available that perform recursive temporal filtering.
The advantage over convolutional filtering is that it uses a lot less memory and is a lot faster to compute.
However, the temporal filter is also more simplified and might not be able to fit a specific temporal profile well.</p>
<p><cite>TemporalLowPassFilterRecursive</cite> is an exponential filter that cuts off high frequencies, while <cite>TemporalHighPassFilterRecursive</cite> is the inverse (a 1, followed by a negative exponential) and cuts off low frequencies.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">convis</span>
<span class="c1"># random amplitudes and phases for a range of frequencies</span>
<span class="n">signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">()</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">2.0</span><span class="p">,</span><span class="mi">5000</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">freq</span><span class="p">)</span>
                 <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span><span class="o">*</span><span class="mf">2.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
                 <span class="k">for</span> <span class="n">freq</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">136</span><span class="p">)],</span><span class="mi">0</span><span class="p">)</span>
<span class="n">f1</span> <span class="o">=</span> <span class="n">convis</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">simple</span><span class="o">.</span><span class="n">TemporalLowPassFilterRecursive</span><span class="p">()</span>
<span class="n">f1</span><span class="o">.</span><span class="n">tau</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.005</span>
<span class="n">f2</span> <span class="o">=</span> <span class="n">convis</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">simple</span><span class="o">.</span><span class="n">TemporalHighPassFilterRecursive</span><span class="p">()</span>
<span class="n">f2</span><span class="o">.</span><span class="n">tau</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.005</span>
<span class="n">f2</span><span class="o">.</span><span class="n">k</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">o1</span> <span class="o">=</span> <span class="n">f1</span><span class="p">(</span><span class="n">signal</span><span class="p">[</span><span class="bp">None</span><span class="p">,</span><span class="bp">None</span><span class="p">,:,</span><span class="bp">None</span><span class="p">,</span><span class="bp">None</span><span class="p">])</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">o2</span> <span class="o">=</span> <span class="n">f2</span><span class="p">(</span><span class="n">signal</span><span class="p">[</span><span class="bp">None</span><span class="p">,</span><span class="bp">None</span><span class="p">,:,</span><span class="bp">None</span><span class="p">,</span><span class="bp">None</span><span class="p">])</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Signal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">o2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;High Pass Filter&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">o1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Low Pass Filter&#39;</span><span class="p">)</span>
<span class="n">signal_f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span>
<span class="n">o1_f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">o1</span><span class="p">)</span>
<span class="n">o2_f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">o2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">o2_f</span><span class="p">)[:</span><span class="mi">2500</span><span class="p">]</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">signal_f</span><span class="p">)[:</span><span class="mi">2500</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;High Pass Filter&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">o1_f</span><span class="p">)[:</span><span class="mi">2500</span><span class="p">]</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">signal_f</span><span class="p">)[:</span><span class="mi">2500</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Low Pass Filter&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Gain&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Transfer Functions of Filters&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">1.25</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//filters-3.py">Source code</a>)</p>
<div class="figure" id="id3">
<img alt="_images/filters-3_00.png" src="_images/filters-3_00.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href=".//filters-3_00.png">png</a>, <a class="reference external" href=".//filters-3_00.hires.png">hires.png</a>, <a class="reference external" href=".//filters-3_00.pdf">pdf</a>)</span></p>
</div>
<div class="figure" id="id4">
<img alt="_images/filters-3_01.png" src="_images/filters-3_01.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href=".//filters-3_01.png">png</a>, <a class="reference external" href=".//filters-3_01.hires.png">hires.png</a>, <a class="reference external" href=".//filters-3_01.pdf">pdf</a>)</span></p>
</div>
</div>
<div class="section" id="nonlinearities">
<h2>Nonlinearities<a class="headerlink" href="#nonlinearities" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="convis.filters.NLRectify">
<em class="property">class </em><code class="descclassname">convis.filters.</code><code class="descname">NLRectify</code><a class="reference internal" href="_modules/convis/filters.html#NLRectify"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.filters.NLRectify" title="Permalink to this definition">¶</a></dt>
<dd><p>Rectifies the input (ie. sets values &lt; 0 to 0)</p>
</dd></dl>

<dl class="class">
<dt id="convis.filters.NLRectifyScale">
<em class="property">class </em><code class="descclassname">convis.filters.</code><code class="descname">NLRectifyScale</code><a class="reference internal" href="_modules/convis/filters.html#NLRectifyScale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.filters.NLRectifyScale" title="Permalink to this definition">¶</a></dt>
<dd><p>Rectifies the input, but transforms the input with a scale and a bias.</p>
<p>Pseudocode:</p>
<blockquote>
<div>out = bias + in * scale
out[out &lt; 0] = 0</div></blockquote>
</dd></dl>

<dl class="class">
<dt id="convis.filters.NLSquare">
<em class="property">class </em><code class="descclassname">convis.filters.</code><code class="descname">NLSquare</code><a class="reference internal" href="_modules/convis/filters.html#NLSquare"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.filters.NLSquare" title="Permalink to this definition">¶</a></dt>
<dd><p>A square nonlinearity with a scalable input weight and bias.</p>
</dd></dl>

<dl class="class">
<dt id="convis.filters.NLRectifySquare">
<em class="property">class </em><code class="descclassname">convis.filters.</code><code class="descname">NLRectifySquare</code><a class="reference internal" href="_modules/convis/filters.html#NLRectifySquare"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.filters.NLRectifySquare" title="Permalink to this definition">¶</a></dt>
<dd><p>A square nonlinearity with a scalable input weight and bias
that cuts off negative values after adding the bias.</p>
</dd></dl>

</div>
</div>


      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        «&#160;&#160;<a href="examples.html">Examples</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="filters_Conv3d.html">Extending Conv3d</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, Jacob Huth.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.6.
    </div>
  </body>
</html>